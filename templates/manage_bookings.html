{% extends "base.html" %}

{% block hero %}
<div class="hero-admin">

  {% endblock %}

  {% block content %}
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

  <div class="container">
    <div class="row">
      <div class="col hero-text-position">
        {% if user.is_authenticated %}
        <h1 class="white-text large-text">Manage your bookings and details</h1>
        {% else %}
        <h1 class="white-text large-text">Please login to see this page</h1>

        <div class="d-grid gap-2 col-6 mx-auto">
          <a class="btn navy-btn" role="button" href="{% url 'account_login' %}">Login</a>

        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
<div class="gold-background">
  <div class="container-fluid">
    <div class="row">
      {% if user.is_authenticated%}
      <!-- <div class="col-md-6 box-heading-background">
      <h2>Parent/Guardian details</h2>
      {% for parent in parents %}
      {% if parent.user_info.pk == user.pk %}
      <div class="card box-body-background">
        <div class="card-body">
          <h5 class="card-title">{{ parent.parent_fname }}
            {{ parent.parent_surname }}</h5>
          <h6 class="card-subtitle mb-2">{{ parent.contact_no }} /
            {{ parent.parent_email }}</h6>
          <p class="card-text"> <a href="/amend_parent/{{ parent.id }}">
              <button class="navy-btn">Edit your details</button>
          </p></a>
        </div>
      </div>{% endif %} {% endfor %}
    </div> -->


      <!-- <h2>Child details</h2> -->
      {% for pupil in pupils %}
      {% if pupil.user_info.pk == user.pk %}
      <div class="col-md-6 box-heading-background">
        <!-- <div class="col-md-12"> -->
        <div class="card box-body-background">
          <div class="card-body">
            <h2 class="pupil-title">{{ pupil.first_name_of_pupil }} {{ pupil.surname_of_pupil }},
              {{ pupil.get_year_gp_display }}</h2>
            {% if pupil.b_mon == True or pupil.b_tues == True or pupil.b_wed == True or pupil.b_thurs == True or pupil.b_fri == True %}
            <p class="center-align-text">Booking Status: {{ pupil.get_booking_approval_status_display }}</p>
            <h6 class="card-subtitle mb-2"><strong>Regular Breakfast Slots: </strong></h6>
            <ul>

              {% if pupil.b_mon == True %}<li>Monday</li>{% endif %}
              {% if pupil.b_tues == True %}<li>Tuesday</li>{% endif %}
              {% if pupil.b_wed == True %}<li>Wednesday</li>{% endif %}
              {% if pupil.b_thurs == True %} <li>Thursday</li>{% endif %}
              {% if pupil.b_fri == True %} <li>Friday</li>{% endif %}
            </ul>

            {% else %}<h6><em>No breakfast slots booked</em></h6>
            {% endif %}
            {% if pupil.s_mon == True or pupil.s_tues == True or pupil.s_wed == True or pupil.s_thurs == True or pupil.s_fri == True %}
            <h6 class="card-subtitle mb-2"><strong>Regular Supper Slots: </strong></h6>
            <ul>
              {% if pupil.s_mon == True %}<li>Monday</li>{% endif %}
              {% if pupil.s_tues == True %}<li>Tuesday</li>{% endif %}
              {% if pupil.s_wed == True %}<li>Wednesday</li>{% endif %}
              {% if pupil.s_thurs == True %} <li>Thursday</li>{% endif %}
              {% if pupil.s_fri == True %} <li>Friday</li>{% endif %}
            </ul>

            {% else %}<em>
              <h6>No supper slots booked
            </em></h6>
            {% endif %}
            <h6><strong>Any Additional Requests</strong><span class="applicable"> (if applicable)</span><strong>
                :</strong></h6>
            <ul>
              {% for date_request in date_requests %}

              {% if date_request.pupil == pupil %} <li>{{ date_request.date_request }}
                ({{ date_request.get_type_of_request_display }}): {{ date_request.get_approval_status_display }}</li>
              {% endif %}{% endfor %}</ul>
            <p class="card-text"> <a href="/amend_pupil/{{ pupil.id }}">
                <button class="navy-btn">Edit regular slots/contact details</button>
              </a><a href="#myModal" class="navy-btn" data-toggle="modal">
                <button class="navy-btn">Delete this child's records </button>
              </a>
              <a href="/date_request/{{ pupil.id }}">
                <button class="navy-btn">Make one-off date request</button>
              </a>
            </p>
          </div>
        </div>
      </div>
      <div id="myModal" class="modal fade">
        <div class="modal-dialog modal-confirm">
          <div class="modal-content">
            <div class="modal-header flex-column">
              <div class="icon-box">
                <i class="fa-solid fa-x"></i>
              </div>
              <h4 class="modal-title w-100">Are you sure?</h4>
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
              <p>Do you really want to delete these records? This will cancel all future bookings, and you will have to
                add their details again to book clubs in the future. This process cannot be undone.</p>
            </div>
            <div class="modal-footer justify-content-center">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
              <a href="/delete_pupil/{{ pupil.id }}"><button type="button" class="btn btn-danger">Delete</button></a>
            </div>
          </div>
        </div>
      </div>

      {% endif %} {% endfor %}
    </div>
  </div>
</div>

{% endif %}
</div>
</div>
{% endblock %}